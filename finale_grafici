# grafico a barre del cazzo per leggere file exel sulle aree dei cluster

# grafico a barre del cazzo per leggere file exel sulle aree dei cluster

library(readxl)
library(ggplot2)
library(dplyr)
library(viridis)

# Impostare la finestra grafica pi√π larga
options(repr.plot.width = 16, repr.plot.height = 8)

# Creazione del grafico con barre distanziate e allineamento corretto delle etichette
ggplot(df, aes(x = LULCC, y = Area_km2, fill = Date)) +
    geom_bar(stat = "identity",
             position = position_dodge(width = 0.95),  # Riempie tutto lo spazio disponibile
             width = 0.85) +  # Barre larghe per occupare l'area al meglio
    
    # Etichette sopra le barre con posizione allineata
    geom_text(aes(label = sprintf("%.1f", Area_km2)),
              position = position_dodge(width = 0.95),  # Stessa posizione delle barre
              vjust = -0.7,  # Leggero spostamento in alto
              size = 2.7,
              fontface = "bold") +  
    
    scale_fill_viridis_d(option = "viridis", direction = -1) +
    
    theme_minimal() +  # Lasciamo il font di default
    theme(
        plot.title = element_text(size = 18, face = "bold", hjust = 0.5, margin = margin(b = 15)),
        axis.title.x = element_text(size = 14, margin = margin(t = 10)),
        axis.title.y = element_text(size = 14, margin = margin(r = 10)),
        axis.text = element_text(size = 12),
        
        # Etichette dell'asse X centrate sotto i gruppi e parallele all'asse
        axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),  
        
        legend.position = "right",
        legend.title = element_text(size = 13, face = "bold"), 
        legend.text = element_text(size = 12),
        
        panel.grid.major.y = element_line(color = "gray85"),
        panel.grid.major.x = element_blank(),
        panel.grid.minor = element_blank(),
        
        plot.margin = margin(t = 5, r = 5, b = 5, l = 5)  # Ottimizza lo spazio
    ) +
    
    labs(title = "Distribuzione dell'area per uso del suolo e periodo",
         x = "Uso del suolo",
         y = expression(paste("Area (", km^2, ")")),
         fill = "Periodo") +
    
    # Rimuoviamo margini inutili per far occupare tutto lo spazio all'asse X
    scale_x_discrete(expand = c(0, 0)) +  
    
    # Eliminazione spazio extra sopra e sotto
    scale_y_continuous(expand = c(0, 0), limits = c(0, 400))
